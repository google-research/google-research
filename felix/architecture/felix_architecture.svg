<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Title: Felix Pages: 1 -->
<svg width="3232pt" height="162pt"
 viewBox="0.00 0.00 3232.00 162.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 158)">
<title>Felix</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-158 3228,-158 3228,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pointing</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="801,-18 801,-113 2877,-113 2877,-18 801,-18"/>
<text text-anchor="middle" x="1839" y="-97.8" font-family="Times,serif" font-size="14.00">Pointing (optional)</text>
</g>
<!-- Inputs -->
<g id="node1" class="node">
<title>Inputs</title>
<polygon fill="none" stroke="black" points="157,-60 0,-60 0,0 157,0 157,-60"/>
<text text-anchor="middle" x="78.5" y="-46.4" font-family="Times,serif" font-size="12.00">{Inputs|input_word_ids</text>
<text text-anchor="middle" x="78.5" y="-33.4" font-family="Times,serif" font-size="12.00">input_mask</text>
<text text-anchor="middle" x="78.5" y="-20.4" font-family="Times,serif" font-size="12.00">input_type_ids</text>
<text text-anchor="middle" x="78.5" y="-7.4" font-family="Times,serif" font-size="12.00">(edit_tags if training)}</text>
</g>
<!-- BertEncoder -->
<g id="node2" class="node">
<title>BertEncoder</title>
<polygon fill="none" stroke="black" points="407,-48 194,-48 194,-12 407,-12 407,-48"/>
<text text-anchor="middle" x="300.5" y="-33.4" font-family="Times,serif" font-size="12.00">BertEncoder</text>
<text text-anchor="middle" x="300.5" y="-20.4" font-family="Times,serif" font-size="12.00">(outputs sequence hidden states)</text>
</g>
<!-- Inputs&#45;&gt;BertEncoder -->
<g id="edge1" class="edge">
<title>Inputs&#45;&gt;BertEncoder</title>
<path fill="none" stroke="black" d="M157.06,-23.52C165.69,-23.37 174.61,-23.29 183.59,-23.26"/>
<polygon fill="black" stroke="black" points="183.73,-26.76 193.73,-23.25 183.73,-19.76 183.73,-26.76"/>
</g>
<!-- Inputs&#45;&gt;BertEncoder -->
<g id="edge15" class="edge">
<title>Inputs&#45;&gt;BertEncoder</title>
<path fill="none" stroke="black" d="M157.06,-36.48C165.69,-36.63 174.61,-36.71 183.59,-36.74"/>
<polygon fill="black" stroke="black" points="183.73,-40.24 193.73,-36.75 183.73,-33.24 183.73,-40.24"/>
</g>
<!-- TagDense -->
<g id="node3" class="node">
<title>TagDense</title>
<polygon fill="none" stroke="black" points="581,-82 444,-82 444,-46 581,-46 581,-82"/>
<text text-anchor="middle" x="512.5" y="-67.4" font-family="Times,serif" font-size="12.00">Dense(num_classes)</text>
<text text-anchor="middle" x="512.5" y="-54.4" font-family="Times,serif" font-size="12.00">&#45;&gt; tag_logits</text>
</g>
<!-- BertEncoder&#45;&gt;TagDense -->
<g id="edge2" class="edge">
<title>BertEncoder&#45;&gt;TagDense</title>
<path fill="none" stroke="black" d="M407.12,-47.1C416.07,-48.55 425.02,-50 433.71,-51.4"/>
<polygon fill="black" stroke="black" points="433.33,-54.89 443.76,-53.03 434.45,-47.98 433.33,-54.89"/>
</g>
<!-- Concat -->
<g id="node6" class="node">
<title>Concat</title>
<polygon fill="none" stroke="black" points="1678,-72 1313,-72 1313,-36 1678,-36 1678,-72"/>
<text text-anchor="middle" x="1495.5" y="-50.9" font-family="Times,serif" font-size="12.00">Concat(bert_output, tag_embedding, position_embedding)</text>
</g>
<!-- BertEncoder&#45;&gt;Concat -->
<g id="edge7" class="edge">
<title>BertEncoder&#45;&gt;Concat</title>
<path fill="none" stroke="black" d="M407.19,-21.6C440.54,-19.58 477.54,-18 511.5,-18 511.5,-18 511.5,-18 1174,-18 1241.76,-18 1317.07,-26.04 1377.66,-34.53"/>
<polygon fill="black" stroke="black" points="1377.24,-38 1387.64,-35.95 1378.23,-31.07 1377.24,-38"/>
</g>
<!-- TagEmbedding -->
<g id="node4" class="node">
<title>TagEmbedding</title>
<polygon fill="none" stroke="black" points="1033,-82 809,-82 809,-46 1033,-46 1033,-82"/>
<text text-anchor="middle" x="921" y="-60.9" font-family="Times,serif" font-size="12.00">Embedding(num_classes, tag_dim)</text>
</g>
<!-- TagDense&#45;&gt;TagEmbedding -->
<g id="edge4" class="edge">
<title>TagDense&#45;&gt;TagEmbedding</title>
<path fill="none" stroke="black" d="M581.08,-64C640.15,-64 727.35,-64 798.5,-64"/>
<polygon fill="black" stroke="black" points="798.88,-67.5 808.88,-64 798.88,-60.5 798.88,-67.5"/>
<text text-anchor="middle" x="695" y="-82.8" font-family="Times,serif" font-size="14.00">edit_tags (argmax in eval)</text>
<text text-anchor="middle" x="695" y="-67.8" font-family="Times,serif" font-size="14.00">or ground&#45;truth in training</text>
</g>
<!-- Outputs -->
<g id="node12" class="node">
<title>Outputs</title>
<polygon fill="none" stroke="black" points="3224,-120 3011,-120 3011,-84 3224,-84 3224,-120"/>
<text text-anchor="middle" x="3117.5" y="-105.4" font-family="Times,serif" font-size="12.00">{Outputs|tag_logits</text>
<text text-anchor="middle" x="3117.5" y="-92.4" font-family="Times,serif" font-size="12.00">(pointing_logits if use_pointing)}</text>
</g>
<!-- TagDense&#45;&gt;Outputs -->
<g id="edge3" class="edge">
<title>TagDense&#45;&gt;Outputs</title>
<path fill="none" stroke="black" d="M552.82,-82.04C567.1,-87.94 583.53,-94.01 599,-98 738.26,-133.97 776.17,-139 920,-139 920,-139 920,-139 2751,-139 2834.91,-139 2929.11,-129.23 3000.85,-119.73"/>
<polygon fill="black" stroke="black" points="3001.38,-123.19 3010.83,-118.39 3000.45,-116.25 3001.38,-123.19"/>
<text text-anchor="middle" x="1820" y="-142.8" font-family="Times,serif" font-size="14.00">tag_logits</text>
</g>
<!-- PositionEmbedding -->
<g id="node5" class="node">
<title>PositionEmbedding</title>
<polygon fill="none" stroke="black" points="1276,-82 1070,-82 1070,-46 1276,-46 1276,-82"/>
<text text-anchor="middle" x="1173" y="-60.9" font-family="Times,serif" font-size="12.00">PositionEmbedding(seq_length)</text>
</g>
<!-- TagEmbedding&#45;&gt;PositionEmbedding -->
<g id="edge5" class="edge">
<title>TagEmbedding&#45;&gt;PositionEmbedding</title>
<path fill="none" stroke="black" d="M1033.11,-64C1042.02,-64 1051.02,-64 1059.93,-64"/>
<polygon fill="black" stroke="black" points="1059.95,-67.5 1069.95,-64 1059.95,-60.5 1059.95,-67.5"/>
</g>
<!-- PositionEmbedding&#45;&gt;Concat -->
<g id="edge6" class="edge">
<title>PositionEmbedding&#45;&gt;Concat</title>
<path fill="none" stroke="black" d="M1276.29,-60.81C1284.87,-60.54 1293.72,-60.26 1302.7,-59.98"/>
<polygon fill="black" stroke="black" points="1303,-63.48 1312.89,-59.67 1302.78,-56.48 1303,-63.48"/>
</g>
<!-- EditDense -->
<g id="node7" class="node">
<title>EditDense</title>
<polygon fill="none" stroke="black" points="1925,-72 1715,-72 1715,-36 1925,-36 1925,-72"/>
<text text-anchor="middle" x="1820" y="-57.4" font-family="Times,serif" font-size="12.00">Dense(hidden_size, gelu)</text>
<text text-anchor="middle" x="1820" y="-44.4" font-family="Times,serif" font-size="12.00">&#45;&gt; edit_tagged_sequence_output</text>
</g>
<!-- Concat&#45;&gt;EditDense -->
<g id="edge8" class="edge">
<title>Concat&#45;&gt;EditDense</title>
<path fill="none" stroke="black" d="M1678.02,-54C1686.97,-54 1695.84,-54 1704.52,-54"/>
<polygon fill="black" stroke="black" points="1704.6,-57.5 1714.6,-54 1704.6,-50.5 1704.6,-57.5"/>
</g>
<!-- OptionalTransformer -->
<g id="node8" class="node">
<title>OptionalTransformer</title>
<polygon fill="none" stroke="black" points="2279,-62 1962,-62 1962,-26 2279,-26 2279,-62"/>
<text text-anchor="middle" x="2120.5" y="-47.4" font-family="Times,serif" font-size="12.00">(query_transformer x TransformerEncoderBlock)</text>
<text text-anchor="middle" x="2120.5" y="-34.4" font-family="Times,serif" font-size="12.00">applied to intermediate_query_embeddings</text>
</g>
<!-- EditDense&#45;&gt;OptionalTransformer -->
<g id="edge9" class="edge">
<title>EditDense&#45;&gt;OptionalTransformer</title>
<path fill="none" stroke="black" d="M1925.4,-50.5C1934.01,-50.21 1942.84,-49.92 1951.76,-49.62"/>
<polygon fill="black" stroke="black" points="1951.99,-53.11 1961.87,-49.28 1951.76,-46.12 1951.99,-53.11"/>
</g>
<!-- KeyDense -->
<g id="node10" class="node">
<title>KeyDense</title>
<polygon fill="none" stroke="black" points="2430,-82 2297,-82 2297,-46 2430,-46 2430,-82"/>
<text text-anchor="middle" x="2363.5" y="-67.4" font-family="Times,serif" font-size="12.00">Dense(query_size)</text>
<text text-anchor="middle" x="2363.5" y="-54.4" font-family="Times,serif" font-size="12.00">&#45;&gt; key_embeddings</text>
</g>
<!-- EditDense&#45;&gt;KeyDense -->
<g id="edge12" class="edge">
<title>EditDense&#45;&gt;KeyDense</title>
<path fill="none" stroke="black" d="M1925.21,-67.99C1937.59,-69.23 1950.06,-70.28 1962,-71 2102.64,-79.45 2138.23,-76.89 2279,-71 2281.54,-70.89 2284.13,-70.77 2286.74,-70.63"/>
<polygon fill="black" stroke="black" points="2287.12,-74.11 2296.9,-70.02 2286.7,-67.13 2287.12,-74.11"/>
</g>
<!-- QueryDense -->
<g id="node9" class="node">
<title>QueryDense</title>
<polygon fill="none" stroke="black" points="2594,-62 2448,-62 2448,-26 2594,-26 2594,-62"/>
<text text-anchor="middle" x="2521" y="-47.4" font-family="Times,serif" font-size="12.00">Dense(query_size)</text>
<text text-anchor="middle" x="2521" y="-34.4" font-family="Times,serif" font-size="12.00">&#45;&gt; query_embeddings</text>
</g>
<!-- OptionalTransformer&#45;&gt;QueryDense -->
<g id="edge10" class="edge">
<title>OptionalTransformer&#45;&gt;QueryDense</title>
<path fill="none" stroke="black" d="M2279.28,-44C2333.46,-44 2391.91,-44 2437.65,-44"/>
<polygon fill="black" stroke="black" points="2437.8,-47.5 2447.8,-44 2437.8,-40.5 2437.8,-47.5"/>
</g>
<!-- Attention -->
<g id="node11" class="node">
<title>Attention</title>
<polygon fill="none" stroke="black" points="2869,-82 2631,-82 2631,-46 2869,-46 2869,-82"/>
<text text-anchor="middle" x="2750" y="-67.4" font-family="Times,serif" font-size="12.00">Attention: query Â· key^T</text>
<text text-anchor="middle" x="2750" y="-54.4" font-family="Times,serif" font-size="12.00">&#45;&gt; pointing_logits (seq_len x seq_len)</text>
</g>
<!-- QueryDense&#45;&gt;Attention -->
<g id="edge11" class="edge">
<title>QueryDense&#45;&gt;Attention</title>
<path fill="none" stroke="black" d="M2594.14,-50.36C2602.63,-51.1 2611.47,-51.88 2620.45,-52.67"/>
<polygon fill="black" stroke="black" points="2620.35,-56.18 2630.62,-53.57 2620.97,-49.21 2620.35,-56.18"/>
</g>
<!-- KeyDense&#45;&gt;Attention -->
<g id="edge13" class="edge">
<title>KeyDense&#45;&gt;Attention</title>
<path fill="none" stroke="black" d="M2430.1,-70.02C2436.15,-70.42 2442.19,-70.76 2448,-71 2504.55,-73.37 2567.1,-72.48 2620.47,-70.67"/>
<polygon fill="black" stroke="black" points="2620.8,-74.16 2630.67,-70.31 2620.55,-67.16 2620.8,-74.16"/>
</g>
<!-- Attention&#45;&gt;Outputs -->
<g id="edge14" class="edge">
<title>Attention&#45;&gt;Outputs</title>
<path fill="none" stroke="black" d="M2869.16,-76.29C2911.35,-80.67 2958.81,-85.61 3000.79,-89.97"/>
<polygon fill="black" stroke="black" points="3000.47,-93.46 3010.78,-91.01 3001.19,-86.49 3000.47,-93.46"/>
<text text-anchor="middle" x="2940" y="-91.8" font-family="Times,serif" font-size="14.00">pointing_logits</text>
</g>
</g>
</svg>
